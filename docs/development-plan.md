# アプリ開発計画書

## 概要

**プロダクト名:** キャリアアップ助成金 申請支援AI（仮）

**コンセプト:** 「申請の失敗をゼロにする」AIアシスタント

**ターゲット:** 社労士事務所（キャリアアップ助成金の申請代行業務）

---

## 開発フェーズ

### Phase 1: MVP（最小実用プロダクト）

**目標:** 社労士の「うっかりミス」を防ぐ基本ツール

| 機能 | 概要 | 技術要素 |
|------|------|----------|
| 賃金3%増額計算ツール | 転換前賃金から必要な転換後賃金を自動計算 | フォーム入力、計算ロジック |
| 申請期限管理 | 転換日から第1期/第2期の申請期限を自動算出、リマインダー | カレンダー、通知機能 |
| 対象者チェックリスト | 対象外条件（3親等、新卒1年未満等）の該当チェック | ルールベース判定 |
| 重点支援対象者判定 | A/B/C区分の自動分類、支給額の自動算出 | ルールベース + 職歴データ |
| ヘルプ・ガイダンス | よくある誤解を防ぐツールチップ、説明的エラーメッセージ | UI/UXコンポーネント |

**想定開発期間:** 要検討（技術スタック選定後に見積もり）

---

### Phase 2: 書類チェック機能

**目標:** 提出前の書類不備を自動検出

| 機能 | 概要 | 技術要素 |
|------|------|----------|
| 必須項目チェック（L1） | 申請書の記入漏れを検出 | OCR、フォーム解析 |
| 添付書類チェック（L2） | 必要書類の過不足を確認 | チェックリスト照合 |

---

### Phase 3: 高度な自動化

**目標:** 書類作成の自動化と整合性チェック

| 機能 | 概要 | 技術要素 |
|------|------|----------|
| 書類間整合性チェック（L3） | 賃金台帳と申請書の金額一致確認 | OCR、データ比較 |
| 要件充足チェック（L4） | 3%増額、6ヶ月雇用等の要件判定 | ドメインロジック |
| 申請書類自動生成 | マスターデータから様式を自動出力 | PDF生成、テンプレートエンジン |

---

## 機能詳細

### 1. 賃金3%増額計算ツール

#### 背景・課題
- 3%増額要件の計算ミスが不支給の主要原因
- 残業代の1分単位計算が煩雑
- 手計算でのヒューマンエラーが発生しやすい

#### 機能要件
- 転換前6ヶ月の賃金データ入力（基本給、各種手当、残業代）
- 転換後に必要な最低賃金額を自動計算
- 「あと◯円上げれば要件クリア」を明示
- 賞与・退職金制度の有無チェック

#### 入力項目
```
転換前6ヶ月間:
- 基本給（月額 × 6ヶ月分）
- 固定手当（役職手当、資格手当、家族手当等）
  ※通勤手当、住宅手当、残業代、賞与は除外

転換後の予定:
- 基本給（月額）
- 固定手当
- 賞与制度の有無（正社員要件確認用）
- 退職金制度の有無（正社員要件確認用）
- 昇給制度の有無（正社員要件確認用）
```

**注意**: 令和3年4月以降、賞与・残業代は3%増額計算の対象外。
詳細は `detailed-design.md` の「賃金3%増額計算ロジック」を参照。

#### 出力
```
- 転換前6ヶ月の賃金総額: ◯◯円
- 必要な転換後6ヶ月賃金: ◯◯円（3%増）
- 必要な月額賃金: ◯◯円
- 現在の設定での増額率: ◯.◯%
- 判定: ✅ 要件クリア / ⚠️ 不足（あと◯円必要）
```

---

### 2. 申請期限管理

#### 背景・課題
- 2ヶ月の申請期限を1日でも過ぎると一切受理されない
- 複数クライアント・複数対象者の期限管理が煩雑
- 手動でのカレンダー管理では漏れが発生

#### 機能要件
- 転換日入力 → 第1期/第2期申請期限を自動計算
- 給与締め日・支払日を考慮した期限算出
- 段階的リマインダー（14日前、7日前、3日前、前日）
- 複数案件の一覧表示・ソート

#### データモデル
```
申請案件:
- クライアント企業名
- 対象労働者名
- 転換日
- 給与締め日
- 給与支払日
- 第1期申請期限（自動計算）
- 第2期申請期限（自動計算）※重点支援対象者のみ
- ステータス:
  - preparing: 準備中
  - documents_ready: 書類準備完了
  - submitted: 申請済
  - under_review: 審査中
  - approved: 支給決定
  - rejected: 不支給
  - expired: 期限切れ
```

詳細は `detailed-design.md` の「データモデル詳細設計」を参照。

#### 画面イメージ
```
┌─────────────────────────────────────────────────┐
│ 申請期限一覧                        [+ 新規登録] │
├─────────────────────────────────────────────────┤
│ 🔴 あと3日  | ㈱ABC商事 | 田中太郎 | 第1期申請  │
│ 🟡 あと14日 | ㈱XYZ工業 | 山田花子 | 第1期申請  │
│ 🟢 あと45日 | ㈱DEF建設 | 佐藤次郎 | 第2期申請  │
└─────────────────────────────────────────────────┘
```

---

### 3. 対象者チェックリスト

#### 背景・課題
- 対象外の労働者を誤って申請 → 不支給
- 要件が複雑で見落としやすい
- 重点支援対象者の判定が煩雑

#### 機能要件
- 労働者情報入力 → 対象可否を即時判定
- 対象外条件の自動チェック
- 重点支援対象者（A/B/C区分）の自動分類
- 不足情報・確認事項の指摘

#### チェック項目

**対象外条件（該当すると申請不可）:**
- [ ] 正規雇用を条件に雇用された
- [ ] 過去3年以内に同一事業所で正社員だった
- [ ] 事業主・役員の3親等以内の親族
- [ ] 新卒で雇入れから1年未満
- [ ] 定年まで1年未満
- [ ] 外国人技能実習生
- [ ] 正社員化を約束して雇用された

**重点支援対象者の判定:**
```
区分A: 雇い入れから3年以上の有期雇用労働者
区分B: 雇い入れから3年未満 かつ
        - 過去5年間に正社員だった期間が合計1年以下
        - 過去1年間に正社員として雇用されていない
区分C: 派遣労働者、母子家庭の母等、父子家庭の父、
        人材開発支援助成金の特定訓練修了者
```

#### 出力例
```
判定結果: ✅ 申請対象です

対象者区分: 重点支援対象者（区分A）
  → 雇い入れから3年2ヶ月経過

支給見込額:
  - 第1期: 40万円
  - 第2期: 40万円
  - 合計: 80万円（中小企業の場合）

確認事項:
  ⚠️ 過去の正社員経験について履歴書で確認してください
```

---

## 技術スタック（案）

### フロントエンド
| 選択肢 | メリット | デメリット |
|--------|---------|-----------|
| Next.js + React | SSR対応、エコシステム充実 | 学習コスト |
| Remix | フォーム処理が得意、高速 | 比較的新しい |

### バックエンド
| 選択肢 | メリット | デメリット |
|--------|---------|-----------|
| Firebase | 認証・DB・ホスティング一体、開発速度 | ベンダーロックイン |
| Supabase | PostgreSQL、オープンソース | Firebaseより機能少 |

### AI/ML
| 用途 | 選択肢 |
|------|--------|
| OCR（書類読み取り） | Google Cloud Vision, Azure Document Intelligence |
| LLM（文書解析） | OpenAI GPT-4, Claude API |
| 画像生成（図解） | DALL-E, Midjourney API |

### 推奨構成（MVP）
```
フロントエンド: Next.js 14 (App Router) + TypeScript
スタイリング: Tailwind CSS
バックエンド: Firebase (Auth, Firestore, Functions)
ホスティング: Vercel or Firebase Hosting
```

---

## データモデル設計（概要）

### Firestore コレクション構成

```
/users/{userId}
  - email
  - displayName
  - role: "sharoushi" | "admin"
  - createdAt

/offices/{officeId}
  - name: 事務所名
  - ownerId: userId
  - plan: "free" | "basic" | "pro"
  - createdAt

/clients/{clientId}
  - officeId: 所属事務所
  - companyName: 企業名
  - registrationNumber: 雇用保険適用事業所番号
  - isSmallBusiness: 中小企業フラグ
  - careerUpManager: キャリアアップ管理者名
  - hasEmploymentRules: 就業規則有無
  - createdAt

/applications/{applicationId}
  - clientId: クライアント企業
  - workerId: 対象労働者ID
  - conversionDate: 転換日
  - phase1Deadline: 第1期申請期限
  - phase2Deadline: 第2期申請期限
  - status: "preparing" | "submitted" | "approved" | "completed"
  - isPriorityTarget: 重点支援対象者フラグ
  - priorityCategory: "A" | "B" | "C" | null
  - estimatedAmount: 見込支給額
  - createdAt

/workers/{workerId}
  - clientId: 所属企業
  - name: 氏名
  - birthDate: 生年月日
  - hireDate: 雇入れ日
  - employmentType: "fixed" | "indefinite" | "dispatch"
  - contractPeriod: 契約期間
  - hasPastRegularEmployment: 過去の正社員経験
  - isRelative: 親族フラグ
  - isNewGraduate: 新卒フラグ
  - preSalary: 転換前賃金データ
  - postSalary: 転換後賃金データ
  - createdAt
```

---

## 画面一覧（MVP）

| 画面 | パス | 概要 |
|------|------|------|
| ログイン | /login | メール/パスワード認証 |
| ダッシュボード | /dashboard | 期限間近の案件一覧、統計 |
| クライアント一覧 | /clients | 顧客企業の一覧・検索 |
| クライアント詳細 | /clients/[id] | 企業情報、対象労働者一覧 |
| 対象者登録 | /clients/[id]/workers/new | 労働者情報入力、対象判定 |
| 対象者詳細 | /workers/[id] | 労働者詳細、申請ステータス |
| 賃金計算 | /tools/salary-calculator | 3%増額計算ツール |
| 申請管理 | /applications | 全申請案件の一覧・フィルタ |

---

## セキュリティ要件

### 取り扱うデータの機密性
- 個人情報（氏名、生年月日、賃金情報）
- 企業情報（登記情報、雇用保険番号）
- 助成金申請に関する情報

### 必須対策
- [ ] Firebase Authentication による認証
- [ ] Firestore Security Rules によるアクセス制御
- [ ] HTTPS 通信の強制
- [ ] 個人情報の暗号化（必要に応じて）
- [ ] 監査ログの記録
- [ ] 定期的なバックアップ

### 将来的な対応
- [ ] 二要素認証（2FA）
- [ ] IPアドレス制限
- [ ] SOC2 / ISMS 対応

---

## 今後の検討事項

### ビジネス面
- [ ] 価格設定（月額SaaS or 申請件数課金）
- [ ] 無料プランの範囲
- [ ] 競合サービスとの差別化

### 機能面
- [ ] 既存労務管理ソフト（freee, MF等）との連携
- [ ] OCRの精度要件と対応フォーマット
- [ ] 厚労省の様式変更への追従方法

### 技術面
- [ ] 技術スタックの最終決定
- [ ] インフラ構成（本番環境）
- [ ] CI/CD パイプライン

---

## マイルストーン

| フェーズ | 内容 | 完了条件 |
|---------|------|----------|
| Phase 0 | 要件定義・設計 | 本ドキュメントの完成、技術スタック決定 |
| Phase 1 | MVP開発 | 賃金計算、期限管理、対象者チェックの実装 |
| Phase 1.5 | ユーザーテスト | 社労士3名以上のフィードバック収集 |
| Phase 2 | 書類チェック機能 | L1〜L2チェック機能の実装 |
| Phase 3 | 高度な自動化 | 書類生成、整合性チェックの実装 |

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-19 | 初版作成 |
| 2025-12-22 | 賃金計算入力項目を修正（賞与除外を明記）、重点支援対象者判定をMVPに移動、ApplicationStatusを拡張、detailed-design.mdへの参照を追加 |
